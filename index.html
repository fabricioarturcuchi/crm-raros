<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CRM - Leads Cons√≥rcio</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f3f3f3;
      margin: 0; padding: 0;
    }
    header {
      background: #b38b00;
      color: #000;
      padding: 20px;
      text-align: center;
      font-size: 1.8rem;
    }
    .container {
      max-width: 900px;
      margin: 30px auto;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    form {
      display: grid;
      grid-template-columns: repeat(auto-fill,minmax(200px,1fr));
      gap: 15px;
      margin-bottom: 20px;
    }
    label { font-weight: bold; margin-bottom: 5px; }
    input, select, button {
      padding: 10px;
      font-size: 1rem;
      border-radius: 5px;
      border: 1px solid #ccc;
      width: 100%;
      box-sizing: border-box;
    }
    button {
      background: #b38b00;
      color: #000;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover { background: #d2af00; }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }
    th { background: #b38b00; color: #000; }
    .action-btn {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      margin: 0 4px;
    }
    .action-btn.edit { color: #0066cc; }
    .action-btn.delete { color: #cc0000; }
    @media(max-width: 600px) {
      form { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

<header>CRM - Leads de Cons√≥rcio</header>
<div class="container">
  <form id="leadForm">
    <input type="hidden" id="leadId" />
    <div>
      <label for="nome">Nome</label>
      <input type="text" id="nome" required/>
    </div>
    <div>
      <label for="telefone">Telefone</label>
      <input type="tel" id="telefone" required/>
    </div>
    <div>
      <label for="email">E-mail</label>
      <input type="email" id="email" required/>
    </div>
    <div>
      <label for="tipoConsorcio">Tipo de Cons√≥rcio</label>
      <select id="tipoConsorcio" required>
        <option value="" disabled selected>-- Selecione --</option>
        <option value="Autom√≥vel">Autom√≥vel</option>
        <option value="Im√≥vel">Im√≥vel</option>
      </select>
    </div>
    <div>
      <label for="valorDesejado">Valor Desejado</label>
      <input type="number" id="valorDesejado" min="0" required/>
    </div>
    <div>
      <label for="valorParcela">Valor da Parcela</label>
      <input type="text" id="valorParcela" readonly />
    </div>
    <div style="grid-column: 1 / -1; text-align:center;">
      <button type="submit">Salvar Lead</button>
    </div>
  </form>

  <table>
    <thead>
      <tr>
        <th>Nome</th><th>Telefone</th><th>Email</th><th>Tipo</th><th>Valor</th><th>Parcela</th><th>A√ß√µes</th>
      </tr>
    </thead>
    <tbody id="leadTable"></tbody>
  </table>
</div>

<script>
  const form = document.getElementById('leadForm');
  const leadIdInput = document.getElementById('leadId');
  const nomeInput = document.getElementById('nome');
  const telInput = document.getElementById('telefone');
  const emailInput = document.getElementById('email');
  const tipoInput = document.getElementById('tipoConsorcio');
  const valorInput = document.getElementById('valorDesejado');
  const parcelaInput = document.getElementById('valorParcela');
  const leadTable = document.getElementById('leadTable');

  const TAXA = { 'Autom√≥vel': 0.16, 'Im√≥vel': 0.22 };
  const PRAZO = { 'Autom√≥vel': 84, 'Im√≥vel': 220 };

  let leads = JSON.parse(localStorage.getItem('leads') || '[]');

  function calcularParcela() {
    const tipo = tipoInput.value;
    const valor = Number(valorInput.value);
    if (TAXA[tipo] && valor > 0) {
      const total = valor * (1 + TAXA[tipo]);
      const parcela = total / PRAZO[tipo];
      parcelaInput.value = parcela.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
    } else parcelaInput.value = '';
  }

  tipoInput.addEventListener('change', calcularParcela);
  valorInput.addEventListener('input', calcularParcela);

  function renderTable() {
    leadTable.innerHTML = '';
    leads.forEach((l, i) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${l.nome}</td>
        <td>${l.telefone}</td>
        <td>${l.email}</td>
        <td>${l.tipoConsorcio}</td>
        <td>${Number(l.valorDesejado).toLocaleString('pt-BR',{style:'currency',currency:'BRL'})}</td>
        <td>${l.valorParcela}</td>
        <td>
          <button class="action-btn edit" onclick="editLead(${i})">‚úé</button>
          <button class="action-btn delete" onclick="deleteLead(${i})">üóëÔ∏è</button>
        </td>`;
      leadTable.appendChild(tr);
    });
  }

  function resetForm() {
    form.reset();
    parcelaInput.value = '';
    leadIdInput.value = '';
  }

  form.addEventListener('submit', e => {
    e.preventDefault();
    const lead = {
      nome: nomeInput.value.trim(),
      telefone: telInput.value.trim(),
      email: emailInput.value.trim(),
      tipoConsorcio: tipoInput.value,
      valorDesejado: valorInput.value,
      valorParcela: parcelaInput.value
    };

    const id = leadIdInput.value;
    if (id) leads[id] = lead;
    else leads.push(lead);

    localStorage.setItem('leads', JSON.stringify(leads));
    renderTable();
    resetForm();
  });

  window.editLead = i => {
    const l = leads[i];
    leadIdInput.value = i;
    nomeInput.value = l.nome;
    telInput.value = l.telefone;
    emailInput.value = l.email;
    tipoInput.value = l.tipoConsorcio;
    valorInput.value = l.valorDesejado;
    parcelaInput.value = l.valorParcela;
  };

  window.deleteLead = i => {
    if (confirm('Deseja realmente excluir esse lead?')) {
      leads.splice(i, 1);
      localStorage.setItem('leads', JSON.stringify(leads));
      renderTable();
    }
  };

  renderTable();
</script>

</body>
</html>
